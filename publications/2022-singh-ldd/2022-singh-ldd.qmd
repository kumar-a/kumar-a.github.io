---
name: "2022-singh-ldd"
title: "Comparative soil restoration potential of exotic and native woody plantations on coal mine spoil in a dry tropical environment of India: A case study"

categories:
- Coal mine
- Restoration
- Journal Article
- Land Degradation & Development

description: |
  We compared the soil restoration potential of exotic and native plant species on coal mine. Our results suggested that native species are more beneficial for soil restoration than the exotic species.
  
author:
  - name: Anand Narain Singh
    url: https://www.researchgate.net/profile/Anand-Singh-15
    affiliation: Panjab University, Chandigarh
    affiliation_url: https://puchd.ac.in
    orcid: 0000-0002-0148-8680
  - name: Abhishek Kumar
    url: https://akumar.netlify.app
    affiliation: Panjab University, Chandigarh
    affiliation_url: https://puchd.ac.in
    orcid: 0000-0003-2252-7623

doi: "10.1002/ldr.4286"
            
date: 02-11-2022

bibliography: refs.bib

reuse: false

citation:
  type: article-journal
  container-title: "Land Degradation & Development"
  doi: "10.1002/ldr.4286"
  volume: 33
  issue: 12
  page: 1971-1984
  
image: thumbnail.png
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = "#>", collapse = TRUE,
                      # figures
                      fig.align = 'center',
                      out.width = "100%", dev = "svglite",
                      # code
                      echo = F, message=FALSE, warning=FALSE)
library(ggdist)
library(ggpubr)
library(gt)
library(rstatix)
library(tidyverse)
```

```{r theme-funcs, include=F}

## theme for figures
fig_theme <- function() {
  theme_bw() +
    theme(strip.text = element_text(size = 13, color = "black"), 
        strip.background = element_rect(fill = "grey98"), 
        
        legend.text = element_text(size = 13),
        
        axis.text = element_text(size = 12, color = "grey40"),
        axis.title = element_text(size = 13, color = "black"),
        
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_blank())
}

################################################################################

## theme for tables
tab_theme <- function(data, ...) {
  
  data |>
    
    # indent rows of first column 
    tab_style(style = cell_text(indent = "12px"),
            locations = cells_body(columns = 1)) |>  
    
    # apa style three lined table
    tab_options(
      column_labels.border.top.width = 2,
      column_labels.border.top.color = "black",
          
      table_body.border.top.color = "black",
      table_body.border.top.width = 3,
          
      table_body.border.bottom.color = "black",
      table_body.border.bottom.width = 2,
          
      table.border.bottom.width = 0,
      table.border.bottom.color = NULL,
          
      # make the width 100%
      table.width = pct(100),
      table.background.color = "white",
      ...
    )
}
```

:::{.callout-note}
This is the original draft, which may differ from published manuscript. Please refer to <https://doi.org/10.1002/ldr.4286>
:::

## Abstract

Overburden excavated during opencast mining has poorer soil properties due to non-salvage and inversion of soil profiles. One of the negative consequences of opencast coal mining is the production of large amounts of nutrient-poor, infertile, and degraded soils. The soil properties of such overburden restoration of such damaged lands are often improved achieved by planting suitable plant species; however, baseline data for selection and performance of plantation species is lacking the performance of species varies site-to-site. Therefore, this paper aims to test the established evaluated the effects of woody plantations on the physico-chemical and biological properties of coal mine spoil. We synthesized the available data from previous studies conducted on 5-year-plantations in Singrauli coalfields of India. These plantations have monoculture of total eight species, in which four were exotic (*Acacia auriculiformis*, *Casuarina equisetifolia*, *Cassia siamea* and *Grevillea pteridifolia*) and four were native species (*Albizia lebbeck*, *Albizia procera*, *Dendrocalamus strictus* and *Tectona grandis*). We compared the soil properties under exotic and native species plantations to evaluate the effect of species origin. Our results showed that the clay content (p < 0.000), ammonium-nitrogen (p < 0.000), inorganic total phosphate (p = 0.009), and microbial biomass nutrients (C, N, and P; p < 0.000) were significantly higher under native plantations than the exotic plantations. Overall, our study suggested that exotic species plantations, either legume or non-leguminous, are not as useful as native species in mine spoil rehabilitation. Thus, native species plantations should be promoted while restoring a coal mine spoil in dry tropical environments.

**Keywords:** ecological restoration, soil redevelopment, exotic species, native species, coal mine spoil, woody plantations

## Introduction

Opencast mining involves excavation and removal of overburden to extract the coal. This removed overburden is dumped aside as large heaps. have poor soil properties due to alterations in soil profile. Since native soils were not salvaged, the surface provides a harsh and heterogeneous media for plant growth. Coal extraction by surface mining (opencast) process drastically alters the mining area's physical and biological nature [@Feng2019]. The leftover coal mine spoil or overburden represent damaged and disrupted ecosystems that are hard to restore into their original state [@Berger1993]. The soils of these coal mine spoil heaps are characterized by high bulk density, pH, low nutrients (carbon, nitrogen and phosphorus) and high concentrations of toxic metals [@Feng2019]. Such soils have limited capability to support vegetation and natural recovery of vegetation is very slow in such ecosystems. The increased concerns about the negative impacts of mining and land degradation have stimulated scientific community to devise technologies to restore such damaged landscapes. The first step in any restoration program should focus on the protection of disturbed habitat and communities from being further wasted. Then attempt to accelerate the re-vegetation process to increase biodiversity and stabilize nutrient cycling [@Singh1995; @Singh2006a; @Singh2006b]. However, the success of a restoration program depends on the quality of planted species, parent material, and environmental conditions [@Singh2002]. Further, providing good surface material such as mulch or some other plant material is useful for enhancing re-vegetation of degraded sites. Therefore, there is a strong need to evaluate the restoration potentials of different plant species to support the restoration practitioners, engineers and scientific community. 

Plantations have been widely employed to restore the damaged and degraded lands. In this context, Fisher [-@Fisher1995] suggested five general hypotheses for the mechanisms that contribute to the amelioration of degraded lands by planting certain desirable species [@Fisher1995]. The mechanisms involve: first, an increase in the soil organic matter contents resulting from carbon (C) fixation in photosynthesis and its transfer via leaf litter and root turnover to the soil. Second, some leguminous trees' nitrogen (N) fixation increases soil N content under the tree canopy. Third, the tree's rhizospheric effect on soils resulted in enhanced N mineralization and increased microbial biomass. Fourth, microclimate modification by tree canopies that moderate soil and air temperatures and soil moisture regimes. Fifth, nutrient pumping reflects the uptake of nutrients from greater depths by tree roots and accumulation in a smaller surface soil volume due to litterfall.

Soil physicochemical properties are greatly influenced by the plant species growing above the soil due to variations in individual species traits [@Waring2015]. The choice of species for restoration of degraded lands remained debatable an area of interest among the scientific community and restoration practitioners. Since exotic and native species are adapted to different local environment, they have differential restoration potential due to variations in functional traits. Exotic plants are recommended for restoration due to their faster growth and biomass production. Further, high disturbance and heterogeneity favors their growth and establishment. However, many researchers pointed out the negative impacts of exotic species on the soil fertility and native flora; therefore suggested to avoid exotic species for restoration program [@Cusack2004; @Diemont2006; @Lugo1990]. In contrast to this, some researchers argued that exotic species may be especially recommended for primary rehabilitation on bare coal mine spoil due to their fast growth and establishment [@DAntonio2002; @Parrotta1999; @Parrotta2001]. Thus, evaluation of species’ effects on coal mine soil properties is vital to assess their suitability for the soil reclamation process. 

The present study addresses this gap by comparing the soil properties under native and exotic woody species established on coal mine spoils after 5-years from the available data. Researchers did an intensive ecological study during 1993–1996 to investigate each planted species' overall effect, either native or exotic or legume or non-legumes, on degraded soil of mine spoils [@Dutta2001; @Dutta2003; @Singh2004a; @Singh2004b; @Singh2006a; @Singh1999; @Singh2001; @Singh1995]. A comparable database between exotic and native species for vegetational and soil components was available only for 5-years-old plantation age. Therefore, in this paper, we compared the restoration efficiency of 5-year-old planted species in both variety (exotic and native) in terms of soil physical properties, total soil nutrients (SOC, TKN, and TP), available nutrients (Mineral N and P), N-mineralization, microbial biomass (MB-C, MB-N, and MB-P) and their nutrients from soil characters in redeveloping soil of mine spoil. We address the following questions from the comparison: 

(1)	Which woody species are suitable for coal mine spoil restoration?
(2) Are exotic and native species differ in their soil restoration potentials?
(3)	Which soil parameters are more affected by origin of species?
(4)	Is there any relationship between soil physicochemical properties under exotic and native plantations? 

## Methods

###	Plantations and sample plots

The plantations under study were situated in the west section of Jayant Block, which is located in the northeastern part of Singrauli Coalfield in the district of Sidhi (M. P.) between latitudes 24°6′45″–24°11′15″ N and longitude 82°36′40″–82°41′15″ E. The study area is situated on a plateau above the plain on its southwest side. The average elevation at the foot of the plateau is around 300 m above mean sea level. The climate of the area is tropical monsoonal, and the year is divisible into a mild winter (November–February), a hot summer (April–June), and a warm rainy season (July–September). Data collected at a meteorological station present on the site showed that the mean monthly minimum temperature within the annual cycle ranges from 6–28°C and the mean monthly maximum from 20–40°C. The rainfall annually averages 1069 mm, of which about 90% occurs during late June to early September. The rainfall is characterized by a high degree of inter-annual variation; as during the study period 1980–1996, it ranges from 700 to 1450 mm/yr [@Singh2004b]. 

###	Experimental design 

All the plantations (exotic and native) were raised in July–August by planting nursery-raised seedlings in previously dug pits of 40 × 40 × 40–cm size at a spacing of 2 × 2–m. Plantations of three native species: *Albizia lebbeck* (L.) Benth., *Albizia procera* (Roxb.) Benth. and *Tectona grandis* L.f. and three exotic species: *Casuarina equisetifolia* L., *Cassia siamea* Lam. and *Grevillea pteridifolia* Knight were raised in 1990 by planting seven to eight months old nursery raised seedlings. However, one native (*Dendrocalamus strictus* (Roxb.) Nees) and one exotic (*Acacia auriculiformis* A.Cunn. ex Benth.) were raised in 1991 by planting eight months of nursery-raised seedlings. The plantations have been raised for land rehabilitation as natural colonization is prolonged on the mine spoil. All the planted plots were seeded in 1994 at the rate of 6 kg/ha with Dinanath grass (*Pennisetum pedicellatum* Trin) to prevent soil erosion and loss of runoff nutrients. The total planted area for *A. lebbeck*, *A. procera*, *C. equisetifolia*, and *G. pteridifolia* was 1.5 ha, each, whereas the same for *T. grandis*, *D. strictus*, *A. auriculiformis* and *C. siamea* was about 0.5 ha, each.
For sampling, three permanent plots were established for each species. The sample plots' size was 25 × 25–m for *A. lebbeck*, *A. procera*, *C. equisetifolia* and *G. pteridifolia*, 15 × 15–m for *T. grandis* and *D. strictus* and 10 × 10–m for *A. auriculiformis* and *C. siamea*. 
Five individuals of average height and diameter (clumps in *D. strictus*) were marked in each replicate plot using waterproof paint for various measurements from 1993. The number of individuals (clumps in *D. strictus*) in each plot was inventoried in February 1993. Data collection was carried out annually in February–March.

###	Sample collection and analyses
Three soil samples were collected at random from each of the three permanent plots using 15 × 15 × 10–cm monoliths during September 1995 and 1996. Each time, the samples from within a plot were thoroughly mixed to yield one composite sample per plot; this yielded three samples for each plantation on each sampling date. Large plant materials were removed, and the field-moist soil was sieved through a 2-mm mesh screen. 

Each soil sample was divided into two parts. One part in the field-moist condition was used to measure available nutrients (NH~4~-N, NO~3~-N, and PO~4~-P) and microbial C, N, and P.
Organic C was determined by dichromate oxidation and titration with ferrous ammonium sulfate [@Allen1986]. Kjeldahl N was determined by the micro Kjeldahl method [@Jackson1958], and NH~4~-N was extracted by 2M KCl and analyzed by the phenate method [@APHA1985]. NO~3~-N was measured by the phenol disulphonic acid method, using CaSO~4~ as the extractant [@Jackson1958]. Bicarbonate extractable P~i~ was determined by the ammonium molybdate-stannous chloride method [@Sparling1985]. The soil was digested in a triple acid mixture of HClO~4~, HNO~3~, and H~2~SO~4~ (1:5:1), and the digest was analyzed for P by a phosphomolybdic acid blue color method [@Jackson1958]. Microbial biomass C, N, and P were determined by chloroform fumigation and extraction methods described earlier [@Singh2004a; @Singh2004b; @Singh1999; @Srivastava1989]. Net nitrogen mineralization, nitrification, and ammonification were determined by in situ buried bag incubation method [@Eno1960]. All results are expressed on an oven-dry soil (105°C, 24 hr) basis.

###	Statistical analyses

Firstly, the collected data was analysed to verify the assumptions of parametric tests. The normality of investigated parameters within groups (i.e., species and origin) was tested using the univariate Shapiro-Wilk test. It has better power than the other normality tests and therefore, it is widely recommended for testing normality. Next, we assessed the investigated parameters for homogeneity of variances across the groups. The Levene's test, which is considered less sensitive to non-normal data, was used to assess the homogeneity of variances across the groups. Shapiro-Wilk test suggested that some variables were not normally distributed in our data. All variables were found to have homogeneous variance across the species, whereas some variables had unequal variances among the origin. The unequal variances among the origin can be compensated by moderate sample size (n = 12).

Since some variables in data violated the assumptions of parametric tests, we chosen the non-parametric Kruskal-Wallis test to observe the effects of plantation species on spoil physicochemical parameters. The Kruskal-Wallis test is a rank-based test, which compares the mean ranks (medians) among the groups regardless of distribution of data. Next, we used the Dunn's post-hoc test to discriminate the differences among the species for each investigated parameter. Dunn's test has two advantages over pairwise Wilcoxon's test: firstly, it retains the ranks produced Kruskal-Wallis test and, secondly, it also incorporates the pooled variance estimate implied by the null hypothesis of the Kruskal-Wallis test. The p-values computed by Dunn's test were adjusted to control the family-wise error rate for multiple comparisons. These adjustments were made using the stepwise Holm method (also called Holm-Bonferroni adjustment), which is considered less conservative and more powerful than the Bonferroni method. We used the Wilcoxon's rank sum test (also known as Mann-Whitney U test) to compare the variables between exotic and native species plantations. This test compares the difference in medians with relaxed assumption of normality of data. Across all the computed p-values, we considered p < 0.05 as significant.

Principal Component Analysis (PCA) with scaling 2 was used to observe the correlations and patterns in the soil properties. Since the soil properties are expressed in different measurement units, we computed PCA from a correlation matrix as correlations are the covariances of standardized variables [@Borcard2018]. Pearson’s correlation coefficient was determined at 0.05 significance level to establish the relationships among soil properties. 

All statistical analyses were performed in `R` language and statistical environment version 4.1.0 [@R2021]. The `rstatix` [@rstatix2021] and `ggpubr` [@ggpubr2020] packages were used for implementing all statistical tests and correlations. The `R` package `tidyverse` was used for data preparation and visualizations [@Wickham2019] and package `vegan` was used for PCA [@vegan2020]. 

```{r assumptions, include=FALSE}
# Assumptions

## 1. Independence of the observations within and across groups,
### can be assumed as the samples were randomly selected and observed

df <- read.csv("soil-data.csv") |>
  mutate(cnr = soc/tkn, cpr = soc/tp, npr = tkn/tp,
         mbcnr = mbc/mbn, mbcpr = mbc/mbp, mbnpr = mbn/mbp,
         rmbc = mbc/soc/100, rmbn = mbn/tkn/100, rmbp = mbp/tp/100, # unit conversion
         mbn2mbc = (mbn/(2*mbc))*100, mbp2mbc = (mbp/(2*mbc))*100
         ) |>
  pivot_longer(cols = -c(Species, Origin, Legume), names_to = "vars", 
               values_to = "values")


################################################################################

# 2. Normality of the data within each group,

## within species
# =========================================

### Variables with zero variance
df |> group_by(Species, vars) |>
  summarise(variance = var(values)) |>
  filter(variance == 0)

### Shapiro-Wilk test by species
df |> group_by(Species, vars) |>
  mutate(variance = var(values)) |>
  filter(variance != 0) |>
  shapiro_test(values) |>
  select(Species, vars, p) |>
  filter(p < 0.05) |>
  arrange(Species, vars)

## within origin (i.e., Exotic vs. Native)
# ========================================

### Shapiro-Wilk test by origin
df |> group_by(Origin, vars) |>
  shapiro_test(values) |>
  select(Origin, vars, p) |>
  filter(p < 0.05) |>
  mutate(p = round(p,3))

################################################################################

# 3. Homoscedasticity: Homogeneity of variance across the groups

## within species
# =========================================
df |> mutate(Species = as.factor(Species)) |>
  group_by(vars) |>
  levene_test(values ~ Species) |>
  filter(p < 0.05)

## within origin (i.e., Exotic vs. Native)
# ========================================
df |> 
  mutate(Origin = as.factor(Origin)) |>
  group_by(vars) |>
  # two or more groups variance comparison for non-normally distributed data
  levene_test(values ~ Origin) |>
  filter(p < 0.05) |>
  mutate(p = round(p,3)) |>
  select(vars, p)

################################################################################

# 4. Outliers using the boxplot method

## within species
# =========================================
df |> group_by(Species, vars) |>
  identify_outliers(values)

## within origin (i.e., Exotic vs. Native)
# ========================================
df |> group_by(Origin, vars) |>
  identify_outliers(values)
```

## Results


### Effect of plantations on spoil physicochemical properties

The primary aim of this paper was to investigate the effects of species and origin on coal mine spoil restoration. Among the spoil physical properties, soil texture parameters (clay, silt and sand content) was significantly differed due to species (@tbl-a). However, bulk density, pH and water holding capacity were found similar under all species plantations (@tbl-a).

```{r}
## read the data, add secondary variables and make longer format
df <- read.csv("soil-data.csv") |>
  mutate(cnr = soc/tkn, cpr = soc/tp, npr = tkn/tp,
         mbcnr = mbc/mbn, mbcpr = mbc/mbp, mbnpr = mbn/mbp,
         # unit conversion
         rmbc = mbc/soc/100, rmbn = mbn/tkn/100, rmbp = mbp/tp/100, 
         mbn2mbc = (mbn/(2*mbc))*100, mbp2mbc = (mbp/(2*mbc))*100
         ) |>
  pivot_longer(cols = -c(Species:Legume), names_to = "vars", 
               values_to = "values")

################################################################################

## calculate effect size
df_effsize <- df |> group_by(vars) |> kruskal_effsize(values ~ Species) |>
  select(vars, effsize)

################################################################################

## Kruskal-Walllis test for effect of species
df_kruskal <- df |> group_by(vars) |>
  mutate(Species = as.factor(Species)) |>
  kruskal_test(values ~ Species) |>
  select(vars, statistic, p)

################################################################################

## prepare data for making table
df_table <- df_kruskal |> 
  # add effect size to kruskal test
  inner_join(df_effsize) |>
  # categorise parameters
  mutate(param_group = 
           case_when(vars %in% c("bd", "ph", "whc", "clay", "silt", "sand") 
                     ~"Physical properties",
                     vars %in% c("ammn", "nitraten", "minn", "pi") 
                     ~"Available nutrients",
                     vars %in% c("soc", "tkn", "tp", "cnr", "cpr", "npr") 
                     ~"Total soil nutrients",
                     vars %in% c("mbc", "mbn", "mbp", "mbcnr", "mbcpr", "mbnpr") 
                     ~"Microbial biomass nutrients",
                     vars %in% c("rmbc", "rmbn", "rmbp", "mbn2mbc", "mbp2mbc") 
                     ~"Relative microbial biomass nutreints",
                     vars %in% c("nitrif", "nminer")
                     ~"Nitrogen cycling"
                     )) |>
  group_by(param_group) |>
  # recode variables
  mutate(vars = recode(vars, 
                            "bd" = "Bulk density (g/cm<sup>3</sup>)", 
                            "ph" = "pH", 
                            "whc" = "Water holding capacity (%)",
                            "sand" = "Soil texture: Sand (%)",
                            "silt" = "Soil texture: Silt (%)",
                            "clay" = "Soil texture: Clay (%)",
                                  
                            "ammn" = "Ammonium-N (mg/kg)", 
                            "nitraten" = "Nitrate-N (mg/kg)",
                            "minn" = "Mineral-N (mg/kg)", 
                            "pi" =  "Phosphate-P (mg/kg)",
                            
                            "soc" = "Soil organic carbon (SOC) (%)",
                            "tkn" = "Total Kjeldahl nitrogen (TKN) (%)",
                            "tp" =  "Total phosphorus (TP) (%)",
                            "cnr" = "SOC: TKN",
                            "cpr" = "SOC: TP",
                            "npr" = "TKN: TP",
                                  
                            "mbc" = "Microbial biomass carbon (MBC) (mg/kg)",
                            "mbn" = "Microbial biomass nitrogen (MBN) (mg/kg)",
                            "mbp" = "Microbial biomass phosphorus (MBP) (mg/kg)",
                            "mbcnr" = "MBC: MBN",
                            "mbcpr" = "MBC: MBP",
                            "mbnpr" = "MBN: MBP",
                            
                            "rmbc" = "MBC: SOC",
                            "rmbn" = "MBN: TKN",
                            "rmbp" = "MBP: TP",
                            "mbn2mbc" = "MBN: 2MBC",
                            "mbp2mbc" = "MBP: 2MBC",
                            
                            "nitrif" = "Nitrification rate (mg kg<sup>-1</sup> month<sup>-1</sup>)",
                            "nminer" = "N-mineralization rate (mg kg<sup>-1</sup> month<sup>-1</sup>)",
                       )
         ) |>
  group_by(param_group) |>
  arrange(vars)

################################################################################
```

```{r}
#| label: tbl-a
#| tbl-cap: "Summary of Kruskal-Wallis test (n = 24; 3 replicates &times; 8 species) with effect size (<i>&eta;<sup>2</sup></i>) for the influence of species on physicochemical properties of mine spoil after five years"

## make the table
df_table |> 
  # gt(caption = html("Summary of Kruskal-Wallis test (n = 24; 3 replicates &times; 8 species) with effect size (<i>&eta;<sup>2</sup></i>) for the influence of species on physicochemical properties of mine spoil after five years")) |>
  gt() |>
  
  fmt_markdown(vars) |>
  fmt_number(c(statistic, p, effsize), decimals = 3) |>

  cols_label(vars = "Parameters", 
             statistic =	md("*H* (7)"), 
             p = md("*p*"), 
             effsize = html("<i>&eta;<sup>2</sup></i>")) |>
  
  row_group_order(groups = c("Physical properties", "Available nutrients", 
                             "Total soil nutrients", 
                             "Microbial biomass nutrients",
                             "Relative microbial biomass nutreints",
                             "Nitrogen cycling"
                             )
                  ) |>
  
  tab_theme()
```


```{r dunn-test, results='hide'}

## read and prepare the data
df <- read.csv("soil-data.csv") |>
  select(-c(Origin, Legume)) |>
  mutate(cnr = soc/tkn, cpr = soc/tp, npr = tkn/tp,
         mbcnr = mbc/mbn, mbcpr = mbc/mbp, mbnpr = mbn/mbp,
         # unit conversion
         rmbc = mbc/soc/100, rmbn = mbn/tkn/100, rmbp = mbp/tp/100, 
         mbn2mbc = (mbn/(2*mbc))*100, mbp2mbc = (mbp/(2*mbc))*100
         ) |>
  pivot_longer(cols = -Species, names_to = "vars", values_to = "values")

################################################################################

## Compute Dunn's post-hoc test with Holm adjustment
df_dunn <- df |> group_by(vars) |>
  dunn_test(values ~ Species) |>
  mutate(group = paste(group1, group2, sep = "-")) |>
  select(vars, group, p.adj) |>
  pivot_wider(names_from = vars, values_from = p.adj)

################################################################################

## compute compact letter display for Dunn's test

## create an empty data list for saving results of individual test
datalist = list()

## run a for loop for each variable
for (i in 2:ncol(df_dunn)) {
  
  # vector for p-values
  var_name <- df_dunn[,i] |> unlist()
  
  # add names to the values from the groups
  names(var_name) <- df_dunn$group
  
  # create compact letter display
  output <- multcompView::multcompLetters(var_name)$Letters
  
  # add a column of variable names
  output["vars"] <- colnames(df_dunn)[i]
  
  # add results to the empty datalist  
  datalist[[i]] <-  output
}

## combine data-lists into a data frame
dunn_grps <- do.call(rbind, datalist) |> as.data.frame() |>
  pivot_longer(cols = -vars, names_to = "Species", values_to = "grps")

################################################################################

## calculate median values
df_median <- df |> group_by(Species, vars) |>
  summarise(values = median(values)) |>
  mutate(values = round(values, 2))

################################################################################

## create a data frame for species effect
species_effect <- df_median |> inner_join(dunn_grps) |>
  mutate(param_group = 
           case_when(vars %in% c("bd", "ph", "whc", "clay", "silt", "sand") 
                     ~"Physical properties",
                     vars %in% c("ammn", "nitraten", "minn", "pi") 
                     ~"Available nutrients",
                     vars %in% c("soc", "tkn", "tp", "cnr", "cpr", "npr") 
                     ~"Total soil nutrients",
                     vars %in% c("mbc", "mbn", "mbp", "mbcnr", "mbcpr", "mbnpr") 
                     ~"Microbial biomass nutrients",
                     vars %in% c("rmbc", "rmbn", "rmbp", "mbn2mbc", "mbp2mbc") 
                     ~"Relative microbial biomass nutrients",
                     vars %in% c("nitrif", "nminer")
                     ~"Nitrogen cycling"
                     ))
```

The present study found that coal mine spoil had almost similar bulk density and neutral pH under both native and exotic plantations (@tbl-a & @fig-a). 

```{r}
#| label: tbl-b
#| tbl-cap: "Physical properties of coal mine spoil under 5-year old plantations of native and exotic woody species"


species_effect |>
  mutate(Species = as.factor(Species)) |>
  filter(param_group == "Physical properties") |>
  mutate(values = paste0(round(values, 2), "<sup>", grps, "</sup>")) |>
  
  dplyr::select(Species, vars, values) |>
  pivot_wider(names_from = vars, values_from = values) |>
  relocate(any_of(c("Species", "bd", "ph", "whc", "clay", "silt", "sand"))) |>
  
  mutate(Origin = ifelse(Species %in% c("Acacia auriculiformis", 
                                        "Casuarina equisetifolia",
                                        "Cassia siamea", 
                                        "Grevillea pteridifolia"),
                         "Exotic", "Native")) |>
  mutate(Species = paste0("*", Species, "*")) |>
  group_by(Origin) |>
  arrange(Species) |>

  gt() |>

  cols_label(Species = "Species", bd = md("BD (g/cm<sup>3</sup>)"),
             ph = "pH", whc = "WHC (%)", clay = "Clay (%)", 
             silt = "Silt (%)", sand = "Sand (%)") |>
  
  cols_width(1 ~ px(150), 2:7 ~ px(60)) |>

  fmt_markdown(everything()) |>
  
  tab_spanner(label = "Soil texture", columns = 5:8) |>
  
  tab_source_note(
    source_note = md(
      c("Data for exotic species obtained from Dutta and Agrawal ([2003](https://doi.org/10.1016/j.ecoleng.2003.10.002)) and Singh et al. ([1995](https://kumar-a.github.io/publications/posts/2022-singh-ee/#ref-Singh1995a))",
        "Values are medians of three replicates",
        "Within the columns, values followed by the same letter are not significantly different at *p* < 0.05, using the Dunn's post-hoc test",
        "BD = Bulk density, WHC = Water holding capacity")
      )
    ) |> 
    
  tab_theme()

```


However, spoil water holding capacity was found significantly higher under exotic plantations than the native plantations (@fig-a).

```{r fig.height=5, fig.width=7}
#| label: fig-a
#| fig-cap: "Spoil physical properties (median &pm; iqr) under exotic and native plantation after 5-years establishment. The significance of difference was determined with Wilcoxon's rank sum test (n = 12; 3 replicates &times; 4 species) and p-values <0.0001, <0.001, <0.01, <0.05 and >0.05  corresponds to `****`, `***`, `**`. `*`, and `ns`, respectively"

df <- read.csv("soil-data.csv") |> 
  select(Origin, bd:ph) |>
  pivot_longer(cols = -Origin, names_to = "vars", values_to = "values") |>
  mutate(vars = factor(vars,
                       levels = c("bd", "ph", "whc", "clay", "silt", "sand"),
                       labels = c("bd" = "BD ~~ '(' * g/cm^{3} * ')'",
                                  "ph" = "pH",
                                  "whc" = "WHC~~ '(' * \'%\' * ')'",
                                  "clay" = "Clay~~ '(' * \'%\' * ')'",
                                  "silt" = "Silt~~ '(' * \'%\' * ')'",
                                  "sand" = "Sand~~ '(' * \'%\' * ')'")
                       )
         )

df_summary <- df |>
  group_by(Origin, vars) |>
  summarise(median = median(values), iqr = IQR(values))

df_test <- df |> group_by(vars) |>
  wilcox_test(values ~ Origin) |>
  mutate(p = round(p, 3)) |>
  add_significance() |>
  
  # compute and add p-value positions
  inner_join(
    df_summary |> mutate(y.position = (median + iqr)*1.175) |> group_by(vars) |> 
      filter(y.position == max(y.position)) |> select(y.position)
  )

## plot
ggplot(df_summary, aes(x = Origin, y = median)) +
  geom_bar(aes(fill = Origin, color = Origin), stat = "identity", width = 0.7,
           alpha = 0.5) +
  geom_errorbar(aes(ymin = median-iqr, ymax = median+iqr), width = 0.05) +
  
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +
  facet_wrap(.~vars, scales = "free", labeller = label_parsed, shrink = TRUE) +
  
  stat_pvalue_manual(df_test, label = "p.signif", size = 5, color = "red",
                     vjust = -0.1) +
  
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  
  labs(x = "", y = "") + 
  fig_theme() +
  theme(legend.position = "none")
  
#ggsave(filename = "fig1.pdf", path = "E:/publications/ANS_Sir/LDD_Spl/figures",
       #height = 4.5, width = 7, units = "in")
```

Similarly, it appeared that silt and sand was significantly higher spoil under exotic plantations as compared to native plantations. But the clay content showed opposite pattern and was found to be significantly higher under native plantations than the exotic plantations. However, ANOVA showed non-significant differences due to species' effect except soil texture (Tables @tbl-a & @tbl-b).

Available nutrients such as ammonium-N (NH~4~-N), nitrate-N (NO~3~-N), mineral-N (NH~4~-N + NO~3~-N) and inorganic-P (PO~4~-P) content indicated significant differences due to species (@tbl-a & @tbl-c). 

```{r}
#| label: tbl-c
#| tbl-cap: "Available nutrients in coal mine spoil under 5-year old plantations of native and exotic woody species"


species_effect |>
    mutate(Species = as.factor(Species)) |>
    filter(vars %in% c("ammn", "nitraten", "minn", "pi")) |>
    mutate(values = paste0(values, "<sup>", grps, "</sup>")) |>
    select(Species, vars, values) |>
    pivot_wider(names_from = vars, values_from = values) |>
    
    mutate(Origin = ifelse(Species %in% c("Acacia auriculiformis", 
                                          "Casuarina equisetifolia",
                                          "Cassia siamea", 
                                          "Grevillea pteridifolia"),
                           "Exotic", "Native")) |>
    mutate(Species = paste0("*", Species, "*")) |>
    group_by(Origin) |>
    arrange(Species) |>
    
    gt() |>
  
    cols_label(Species = md("Species <br></br>"), ammn = md("NH<sub>4</sub>-N <br>(mg/kg)</br>"),
               nitraten = md("NO<sub>3</sub>-N <br>(mg/kg)</br>"), 
               minn = md("Mineral-N <br>(mg/kg)</br>"), 
               pi = md("PO<sub>4</sub>-P <br>(mg/kg)</br>")) |>
  
    cols_width(1 ~ px(150), 2:5 ~ px(75)) |>
    
    fmt_markdown(everything()) |>
    tab_source_note(
        source_note = md(
            c("Data for exotic species obtained from Dutta and Agrawal ([2003](https://doi.org/10.1016/j.ecoleng.2003.10.002)) and Singh et al. ([1995](https://kumar-a.github.io/publications/posts/2022-singh-ee/#ref-Singh1995a))",
              "Values are medians of three replicates",
              "Within the columns, values followed by the same letter are not significantly different at *p* < 0.05, using the Dunn's post-hoc test")
        )
    ) |>
  
    tab_theme()
```

A comparison between exotic and native species plantations revealed that NH~4~-N was significantly higher whereas NO~3~-N was significantly lower under native plantations as compared to exotic plantations (@fig-b). Since mineral-N is the sum of NH~4~-N and NO~3~-N, no significant differences were observed for mineral-N under exotic and native species plantations (@fig-b). However, inorganic phosphorus (PO~4~-P) was found significantly higher under native plantations than the exotic plantations (@fig-b).

```{r fig.height=5, fig.width=7}
#| label: fig-b
#| fig-cap: "Available nutrients in coal mine spoil under exotic and native plantation after 5-years of the establishment. The significance of difference was determined with Wilcoxon's rank sum test (n = 12; 3 replicates of each 4 species) and p-values <0.0001, <0.001, <0.01, <0.05 and >0.05  corresponds to `****`, `***`, `**`. `*` and `ns`, respectively"

read.csv("soil-data.csv") |> 
  select(Origin, ammn:pi) |>
  pivot_longer(cols = -Origin, names_to = "vars", values_to = "values") |>
  mutate(vars = factor(vars,
                       levels = c("nitraten", "ammn", "minn", "pi"),
                       labels = c("ammn" = "NH[4]-N", 
                                  "nitraten" = "NO[3]-N", 
                                  "minn" = "Mineral-N",
                                  "pi" = "PO[4]-P")
                       )
         ) |>
  
  ## plot
  ggplot(aes(x = vars, y = values, color = Origin, fill = Origin)) +

  geom_boxplot(alpha = 0.1, width = 0.5, size = 0.75,
               position = position_dodge(0.6)) +
  
  geom_dotplot(binaxis = "y", color = "black",
               position = position_dodge(0.6),
               stackdir = "center",
               alpha = 0.6, dotsize = 0.6) +
  
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +
  scale_x_discrete(labels = scales::parse_format()) +
  
  labs(x = "", y = expression(mg/kg)) +
  ylim(0, 11) +
  stat_compare_means(method = "wilcox.test", paired = F, 
                     label = "p.signif", label.y = c(2.5, 4.5, 6.5, 10.5), 
                     size = 5, color = "red", show.legend = F) +
  theme_bw() +
  
  guides(fill = guide_legend(direction = "horizontal"), 
         color = guide_legend(direction = "horizontal")) +
  
  fig_theme() +
  theme(legend.position = c(0.18, 0.9), 
        legend.key.size = unit(1, "cm"),
        legend.title = element_blank())

#ggsave(filename = "fig2.pdf", path = "D:/publications/ANS_Sir/LDD_Spl/figures",
       #height = 5, width = 7, units = "in")
```


The concentration of total soil nutrients (C, N, and P) was also significantly varied due to species as indicated by ANOVA (@tbl-a & @tbl-d). 

```{r}
#| label: tbl-d
#| tbl-cap: "Total soil nutrients in coal mine spoil under 5-year old plantations of native and exotic woody species"


species_effect |>
    mutate(Species = as.factor(Species)) |>
    filter(param_group == "Total soil nutrients") |>
    mutate(values = paste0(round(values, 2), "<sup>", grps, "</sup>")) |>
  
    select(Species, vars, values) |>
    pivot_wider(names_from = vars, values_from = values) |>
    relocate(any_of(c("Species", "soc", "tkn", "tp", "cnr", "cpr", "npr"))) |>    
    mutate(Origin = ifelse(Species %in% c("Acacia auriculiformis", 
                                          "Casuarina equisetifolia",
                                          "Cassia siamea", 
                                          "Grevillea pteridifolia"),
                           "Exotic", "Native")) |>
    mutate(Species = paste0("*", Species, "*")) |>
    group_by(Origin) |>
    arrange(Species) |>
    
    gt() |>
  
    cols_label(Species = "Species", soc = "SOC (%)", tkn = "TKN (%)", 
               tp = "TP (%)", cnr = "SOC: TKN", cpr = "SOC: TP", 
               npr = "TKN: TP") |>
  
    cols_width(1 ~ px(150), 2:7 ~ px(70)) |>
    
    fmt_markdown(everything()) |>
    tab_source_note(
        source_note = md(
            c("Data for exotic species obtained from Dutta and Agrawal ([2003](https://doi.org/10.1016/j.ecoleng.2003.10.002)) and Singh et al. ([1995](https://kumar-a.github.io/publications/posts/2022-singh-ee/#ref-Singh1995a))",
              "Values are medians of three replicates",
              "Within the columns, values followed by the same letter are not significantly different at *p* < 0.05, using the Dunn's post-hoc test",
              "SOC = Soil organic carbon, TKN = Total Kjeldahl nitrogen, TP = Total phosphorus")
        )
    ) |>
  
    tab_theme()
```

The maximum concentration for soil organic carbon (SOC) and total kjeldahl nitrogen (TKN) was found in *Albizia lebbeck* (a native species) followed by *Dendrocalamus strictus* (@tbl-d). Although native plantations (*A. lebbeck*, *A. procera* and *D. strictus*), except *T. grandis* plantation, showed a higher SOC and TKN than exotic plantations, these differences were not found to be statistically significant. The comparison between exotic and native plantations indicated that differences in SOC, TKN and their ratio (SOC: TKN) were non-significant, whereas. total Total phosphorus (TP) was significantly lower, and whereas SOC:TP and TKN:TP ratio were significantly higher under exotic plantations than the native plantations after 5-years of establishment (@fig-c).

```{r}
#| label: fig-c
#| fig-cap: "Total soil nutrients in coal mine spoil under exotic and native plantation after 5-years of the establishment. The central white diamond represents the mean of each variable. The significance of difference was determined with Wilcoxon's rank sum test (n = 12; 3 replicates &times; 4 species) and p-values <0.0001, <0.001, <0.01, <0.05 and >0.05  corresponds to `****`, `***`, `**`. `*`, and `ns`, respectively"


## prepare the data
read.csv("soil-data.csv") |> 
  select(Origin, soc:tp) |>
  mutate(soctkn = soc/tkn, soctp = soc/tp, tkntp = tkn/tp) |> 
  pivot_longer(cols = -Origin, names_to = "vars", values_to = "values") |>
  mutate(vars = factor(vars, 
                       levels = c("soc", "tkn", "tp", "soctkn", "soctp", 
                                  "tkntp"),
                       labels = c("soc" = "'SOC (%)'", "tkn" = "'TKN (%)'", 
                                  "tp" = "'TP (%)'",
                                  "soctkn" = "SOC * ': ' * TKN",
                                  "soctp" = "SOC * ': ' * TP",
                                  "tkntp" = "TKN * ': ' * TP")
                       )
         ) |>

  ggplot(aes(x = Origin, y = values, fill = Origin)) + 
  geom_violin(trim = FALSE, alpha = 0.2, show.legend = FALSE, color = NA) +
  geom_jitter(aes(color = Origin), width = 0.1, alpha = 0.25, size = 2, 
              show.legend = FALSE) +
  
  stat_summary(aes(color = Origin), fun = "median", geom = "point", 
               shape = 23, size = 3.5, stroke = 1, 
               fill = "white", show.legend = F) +
  
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +
  
  stat_compare_means(comparisons = list(c("Exotic", "Native")), 
                     method = "wilcox.test", label = "p.signif", size = 5, 
                     color = "red") +
  facet_wrap(.~vars, scales = "free", labeller = label_parsed) +

  fig_theme() +
  theme(axis.title = element_blank())
```

In this study, soil microbial biomass carbon (MB-C), microbial biomass nitrogen (MB-N), and microbial biomass phosphorus (MB-P) were found to be significantly varied due to the effect of species (@tbl-e). This was evident from the results of ANOVA which showed highly significant differences in MB-C, MB-N, MB-P, and their ratios due to species (@tbl-a). 

```{r}
#| label: tbl-e
#| tbl-cap: "Microbial biomass nutrients in coal mine spoil under 5-year old plantations of native and exotic woody species"


species_effect |>
    mutate(Species = as.factor(Species)) |>
    filter(param_group == "Microbial biomass nutrients") |>
    mutate(values = paste0(round(values, 2), "<sup>", grps, "</sup>")) |>
    select(Species, vars, values) |>
    pivot_wider(names_from = vars, values_from = values) |>
    relocate(any_of(c("Species", "mbc", "mbn", "mbp", "mbcnr", "mbcpr", "mbnpr"))) |>
    mutate(Origin = ifelse(Species %in% c("Acacia auriculiformis", 
                                          "Casuarina equisetifolia",
                                          "Cassia siamea", 
                                          "Grevillea pteridifolia"),
                           "Exotic", "Native")) |>
    mutate(Species = paste0("*", Species, "*")) |>
    group_by(Origin) |>
    arrange(Species) |>
    
    gt() |>
  
    cols_label(Species = "Species", mbc = "MBC (mg/kg)", mbn = "MBN (mg/kg)", 
               mbp = "MBP (mg/kg)", mbcnr = "MBC: MBN", mbcpr = "MBC: MBP", 
               mbnpr = "MBN: MBP") |>
  
    cols_width(1 ~ px(150), 2:7 ~ px(60)) |>
    
    fmt_markdown(everything()) |>
    tab_source_note(
        source_note = md(
            c("Data for exotic species obtained from Dutta and Agrawal ([2003](https://doi.org/10.1016/j.ecoleng.2003.10.002)) and Singh et al. ([1995](https://kumar-a.github.io/publications/posts/2022-singh-ee/#ref-Singh1995a))",
              "Values are medians of three replicates",
              "Within the columns, values followed by the same letter are not significantly different at *p* < 0.05, using the Dunn's post-hoc test",
              "MBC = Microbial biomass carbon, MBN = Microbial biomass nitrogen, 
              MBP = Microbial biomass phosphorus")
        )
    ) |>
  
    tab_theme()
```

Further, all the microbial biomass nutrients analysed in this study were found to be significantly higher under native plantations as compared to exotic plantations after 5-years of their establishment (@fig-d). As a result the ratios of microbial biomass nutrients were also found to be significantly varied among exotic and native species and MB-C:MB-N, MB-C:MB-P, and MB-N:MB-P are found to be significantly lower in native species as compared to the exotic species (@fig-d).

```{r}
#| label: fig-d
#| fig-cap: "Soil microbial biomass nutrients in coal mine spoil under exotic and native plantation after 5-years of the establishment. The significance of difference was determined with Wilcoxon's rank sum test (n = 12; 3 replicates &times; 4 species) and p-values <0.0001, <0.001, <0.01, <0.05 and >0.05  corresponds to `****`, `***`, `**`. `*` and `ns`, respectively"


read.csv("soil-data.csv") |>
  select(Species:Legume, mbc:mbp) |>
  mutate(mbcmbn = mbc/mbn, mbcmbp = mbc/mbp, mbnmbp = mbn/mbp) |>
  pivot_longer(cols = -c(Species, Origin, Legume), names_to = "vars", 
               values_to = "values") |>
  mutate(vars = fct_relevel(vars, c("mbc", "mbn", "mbp", "mbcmbn", "mbcmbp", 
                                    "mbnmbp"))) |>
  mutate(vars = recode(vars, mbc = "MB-C (mg/kg)", mbn = "MB-N (mg/kg)",
                       mbp = "MB-P (mg/kg)", mbcmbn = "MB-C: MB-N", 
                       mbcmbp = "MB-C: MB-P", mbnmbp = "MB-N: MB-P")) |>
  
  ggplot(aes(x = Origin, y = values, fill = Origin)) + 
  geom_violin(trim = FALSE, alpha = 0.2, show.legend = FALSE, color = NA) +
  
  geom_boxplot(aes(color = Origin), outlier.alpha = 0.5, coef = 1.5, 
               width = 0.15, fill = "white", show.legend = FALSE) +
  
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +
  
  stat_compare_means(comparisons = list(c("Exotic", "Native")), 
                     method = "wilcox.test", label = "p.signif", size = 5, 
                     color = "red") +
  facet_wrap(.~vars, scales = "free") +
  
  fig_theme() +
  theme(axis.title = element_blank())

#ggsave(filename = "fig4.pdf", path = "D:/publications/ANS_Sir/LDD_Spl/figures",
       #height = 5, width = 7, units = "in")
```

When we analysed the microbial biomass nutrients as the fraction of total soil nutrients, we found similar results. The proportional microbial biomass nutrients were also found to be significantly varied due to the effect of species (@tbl-b). The microbial biomass carbon (MB-C) accounted for 3.73–7.49% under native and 2.43–2.61% under exotic plantations of the total soil organic carbon (SOC) in the respective plantations. Similarly, the microbial biomass nitrogen (MB-N) was 4.76–10.84% under native plantations and 2.12–3.02% of total Kjeldahl nitrogen (TKN) was in the exotic plantations (@tbl-f). 

```{r}
#| label: tbl-f
#| tbl-cap: "Microbial biomass nutrients relative to total nutrients in coal mine spoil under 5-year old plantations of native and exotic woody species"


species_effect |>
    mutate(Species = as.factor(Species)) |>
    filter(param_group == "Relative microbial biomass nutrients") |>
    mutate(values = paste0(round(values, 2), "<sup>", grps, "</sup>")) |>
    select(Species, vars, values) |>
    pivot_wider(names_from = vars, values_from = values) |>
    relocate(any_of(c("Species", "rmbc", "rmbn", "rmbp", "mbn2mbc", "mbp2mbc"))) |>
    mutate(Origin = ifelse(Species %in% c("Acacia auriculiformis", 
                                          "Casuarina equisetifolia",
                                          "Cassia siamea", 
                                          "Grevillea pteridifolia"),
                           "Exotic", "Native")) |>
    mutate(Species = paste0("*", Species, "*")) |>
    group_by(Origin) |>
    arrange(Species) |>
    
    gt() |>
  
    cols_label(Species = "Species", rmbc = "RMBC (%)", rmbn = "RMBN (%)", 
               rmbp = "RMBP (%)", mbn2mbc = "MBN: 2MBC", mbp2mbc = "MBP: 2MBC") |>
  
    cols_width(1 ~ px(150), 2:7 ~ px(60)) |>
    
    fmt_markdown(everything()) |>
    tab_source_note(
        source_note = md(
            c("Data for exotic species obtained from Dutta and Agrawal ([2003](https://doi.org/10.1016/j.ecoleng.2003.10.002)) and Singh et al. ([1995](https://kumar-a.github.io/publications/posts/2022-singh-ee/#ref-Singh1995a))",
              "Values are medians of three replicates",
              "Within the columns, values followed by the same letter are not significantly different at *p* < 0.05, using the Dunn's post-hoc test",
              "RMBC = Relative microbial biomass carbon, 
              RMBN = Relative microbial biomass nitrogen, 
              RMBP = Relative microbial biomass phosphorus")
        )
    ) |>
  
  tab_theme() ##|>
  
  #gtsave(filename = "table6.rtf", path = "D:/publications/ANS_Sir/LDD_Spl/tables")
```

The comparison between exotic and native species suggested that the relative proportion of microbial nutrients to the total soil nutrients was higher under native plantations than the exotic plantations (@fig-e).

```{r}
#| label: fig-e
#| fig-cap: "Soil microbial biomass nutrients relative to total nutrients in coal mine spoil under exotic and native plantation after 5-years of the establishment. The significance of difference was determined with Wilcoxon's rank sum test (n = 12; 3 replicates &times; 4 species) and p-values <0.0001, <0.001, <0.01, <0.05 and >0.05  corresponds to `****`, `***`, `**`. `*` and `ns`, respectively."

read.csv("soil-data.csv") |>
  mutate(rmbc = mbc/soc/100, rmbn = mbn/tkn/100, rmbp = mbp/tp/100, # unit conversion
         mbn2mbc = (mbn/(2*mbc))*100, mbp2mbc = (mbp/(2*mbc))*100) |>
  select(Species:Legume, rmbc:mbp2mbc) |>
  pivot_longer(cols = -c(Species, Origin, Legume), names_to = "vars", 
               values_to = "values") |>
  mutate(vars = fct_relevel(vars, c("rmbc", "rmbn", "rmbp", "mbn2mbc", 
                                    "mbp2mbc"))) |>
  mutate(vars = recode(vars, rmbc = "RMBC (%)", rmbn = "RMBN (%)", 
                       rmbp = "RMBP (%)", mbn2mbc = "MBN: 2MBC", 
                       mbp2mbc = "MBP: 2MBC")) |>
  
  ggplot(aes(x = Origin, y = values)) + 
  
  geom_dotplot(aes(fill = Origin, color = Origin), binaxis = "y", #color = NA,
               stackdir = "center",
               alpha = 0.3, dotsize = 2) +
  
  stat_pointinterval(aes(color = Origin), 
                     
                     shape = 21, point_fill = "white", point_size = 3.5,
                     stroke = 1,
                     
                     interval_alpha = 0.2, interval_size = 10) +
  
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +  
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +
  
  stat_compare_means(comparisons = list(c("Exotic", "Native")), 
                     method = "wilcox.test", label = "p.signif", size = 5, 
                     color = "red") +
  scale_y_continuous(expand = c(0.15, 0)) +
  facet_wrap(.~vars, scales = "free") +

  fig_theme() +
  theme(legend.position = "none",
        axis.title = element_blank())

#ggsave(filename = "fig5.pdf", path = "D:/publications/ANS_Sir/LDD_Spl/figures",
       #height = 5, width = 7, units = "in")
```

The estimated nitrification and nitrogen mineralization rates indicated significant variations due to species (@tbl-a).

```{r}
#| label: tbl-g
#| tbl-cap: "Nitrification and nitrogen mineralisation in coal mine spoil under 5-year old plantations of native and exotic woody species."


species_effect |>
    mutate(Species = as.factor(Species)) |>
    filter(param_group == "Nitrogen cycling") |>
    mutate(values = paste0(round(values, 2), "<sup>", grps, "</sup>")) |>
    select(Species, vars, values) |>
    pivot_wider(names_from = vars, values_from = values) |>
    
    mutate(Origin = ifelse(Species %in% c("Acacia auriculiformis", 
                                          "Casuarina equisetifolia",
                                          "Cassia siamea", 
                                          "Grevillea pteridifolia"),
                           "Exotic", "Native")) |>
    mutate(Species = paste0("*", Species, "*")) |>
    group_by(Origin) |>
    arrange(Species) |>
    
    gt() |>
  
    cols_label(Species = "Species", 
               nitrif = md("Nitrification rate <br>(mg kg<sup>-1</sup> month<sup>-1</sup>)</br>"),
               nminer = md("N-mineralization rate <br>(mg kg<sup>-1</sup> month<sup>-1</sup>)</br>")) |>
  
    cols_width(1 ~ px(200), 2:3 ~ px(100)) |>
    
    fmt_markdown(everything()) |>
    tab_source_note(
        source_note = md(
            c("Data for exotic species obtained from Dutta and Agrawal ([2003](https://doi.org/10.1016/j.ecoleng.2003.10.002)) and Singh et al. ([1995](https://kumar-a.github.io/publications/posts/2022-singh-ee/#ref-Singh1995a))",
              "Values are medians of three replicates",
              "Within the columns, values followed by the same letter are not significantly different at *p* < 0.05, using the Dunn's post-hoc test")
        )
    ) |>
  tab_theme() ##|>
  
  #gtsave(filename = "table7.rtf", path = "D:/publications/ANS_Sir/LDD_Spl/tables")
```


Nitrification rates were found significantly higher under exotic plantations as compared to native plantations (@fig-f). But no significant differences were observed for nitrogen mineralization rates under exotic and native plantations (@fig-f). However, it showed high variability under native plantations (3.62–8.59 mg kg^-1^ month^-1^) as compared to exotic plantations (5.01–5.35 mg kg^-1^ month^-1^). 

```{r fig.width=7, fig.height=4}
#| label: fig-f
#| fig-cap: "Nitrification and N-mineralisation rates in coal mine spoil under exotic and native plantation after 5-years of the establishment. The significance of difference was determined with Student's t-test (n = 12; 3 replicates &times; 4 species) and p-values <0.0001, <0.001, <0.01, <0.05 and >0.05  corresponds to `****`, `***`, `**`, `*` and `ns`, respectively"

read.csv("soil-data.csv") |>
  select(Species:Legume, nitrif:nminer) |>
  pivot_longer(cols = -c(Species, Origin, Legume), names_to = "vars", 
               values_to = "values") |>
  mutate(vars = fct_relevel(vars, c("nitrif", "nminer"))) |>
  mutate(vars = recode(vars, 
                       nitrif = "atop(Nitrification, '('*mg~kg^{-1}~month^{-1}*')')", 
                       nminer = "atop(N-mineralisation, '('*mg~kg^{-1}~month^{-1}*')')")) |>
  
  
  ggplot(aes(x = Origin, y = values)) +
  
  stat_halfeye(aes(fill = Origin), trim = T, alpha = 0.2, side = "left",
               justification = 1.1,
               .width = 0, point_color = NA) +
  
  stat_pointinterval(aes(color = Origin),
                     shape = 21, point_fill = "white", point_size = 4,
                     stroke = 1.1,
                     interval_alpha = 0.2, interval_size = 10) + 
  
  geom_point(aes(color = Origin), shape = 95, 
             size = 10, alpha = 0.3,
             position = position_nudge(x = 0.2)) +
  
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  
  scale_y_continuous(expand = expansion(mult = c(0.1, 0.1))) +
  
  facet_wrap(~vars, scales = "free_y", labeller = label_parsed) +
  
  stat_compare_means(aes(y = values*1.5), 
                     comparisons = list(c("Exotic", "Native")), 
                     method = "t.test", paired = F,
                     label = "p.signif", label.y.npc = 0.9,
                     color = "red",
                     size = 5, show.legend = F) + 
  
  fig_theme() +
  theme(legend.position = "none",
        axis.title = element_blank())

#ggsave(filename = "fig6.pdf", path = "D:/publications/ANS_Sir/LDD_Spl/figures",
       #height = 4, width = 7, units = "in")
```

###	Inter-relationship in soil vegetation redevelopment under exotic and native plantations

This study found a non-significant positive relationship between microbial biomass carbon and soil organic carbon (@fig-g). However, this relationship was significant under native species plantations but non-significant under exotic plantations (@fig-g). 


```{r}
#| label: fig-g
#| fig-cap: "Relationship between microbial biomass carbon (MB-C) and soil organic carbon (SOC). The strength of the relationship is tested using the linear Pearson's correlation coefficient (represented as *r*) at a 0.05 significance level."


read.csv("soil-data.csv") |> 
  
  ggplot(aes(x = soc, y = mbc)) +
  geom_point(aes(shape = Origin, fill = Origin), size = 5, color = "grey40",
             alpha = 0.5) +
  scale_shape_manual(values = c(21, 24)) +
  
  geom_smooth(aes(color = Origin), method = "lm", 
              lwd = 1.2, se = FALSE, show.legend = FALSE) +

  stat_cor(aes(label = paste(..r.label.., ..p.label.., sep = "~`,`~")), 
           method = "pearson", cor.coef.name = "r", label.x = 0.2, label.y = 300,
           p.accuracy = 0.001, size = 5) +
  stat_cor(aes(color = Origin), method = "pearson", cor.coef.name = "r",
           label.x = c(0.6, 0.53), label.y = c(175, 245), p.accuracy = 0.001,
           size = 5, show.legend = FALSE) +
  
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9")) +

  labs(x = "Soil Organic Carbon (%)", y = "Microbial Biomass Carbon (mg/kg)") +
  
  theme_bw() +
  theme(legend.position = c(0.176, 0.92), legend.title = element_blank(),
        legend.direction = "horizontal", legend.text = element_text(size = 14),
        axis.text = element_text(size = 12, color = "grey30"),
        axis.title = element_text(size = 14, color = "black"),
        axis.ticks.length = unit(1.5, "mm"), axis.line = element_line(size = 0.5),
        axis.ticks = element_line(size = 0.5))

#ggsave(filename = "fig7.pdf", path = "D:/publications/ANS_Sir/LDD_Spl/figures",
       #height = 5, width = 7, units = "in")
```

Further, microbial biomass nutrients were found to be associated with soil texture. All the microbial biomass nutrients exhibited a significant positive relationship with soil clay content and a significant negative relationship with soil sand content (@fig-h). Although the soil silt content was showed a non-significant negative association with microbial biomass carbon and microbial biomass phosphorus, it displayed a significant negative relation with microbial biomass nitrogen (@fig-h). However, most of these relationships were not found to be significant under exotic and native plantations, when analysed separately. 

```{r fig.width=7, fig.height=6.5}
#| label: fig-h
#| fig-cap: "Relationship between microbial biomass nutrients and soil texture. The strength of relationship is tested using the linear Pearson's correlation coefficient (represented as *r*) at 0.05 significance level."


read.csv("soil-data.csv") |>
  select(Origin, sand:clay, mbc:mbp) |>
  pivot_longer(cols = sand:clay, names_to = "soil_texture", 
               values_to = "values_st") |>
  mutate(soil_texture = fct_relevel(soil_texture, c("clay", "silt", "sand"))) |>
  mutate(soil_texture = stringr::str_to_title(soil_texture)) |>
  pivot_longer(cols = mbc:mbp, names_to = "microbial_nutrients", 
               values_to = "values_mn") |>
  mutate(microbial_nutrients = toupper(microbial_nutrients)) |>
  
  ggplot(aes(x = values_st, y = values_mn)) +
  geom_point(aes(color = Origin, shape = Origin), size = 3, alpha = 0.5) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  geom_smooth(alpha = 0.2, method = "lm", lwd = 1, se = FALSE) +
  stat_cor(aes(y = values_mn * 1.25), 
           label.y.npc = 1, cor.coef.name = "r", 
           p.accuracy = 0.001) +

  facet_grid(microbial_nutrients ~ soil_texture, scales = "free") +
  theme_bw() +
  labs(x = "Soil texture (%)", y = "Microbial biomass nutrients (mg/kg)") +
  theme(legend.position = "top", legend.title = element_blank(), 
        legend.text = element_text(size = 12),
        strip.background = element_rect(fill = "grey98"),
        strip.text = element_text(size = 13),
        axis.text = element_text(size = 12, color = "grey40"),
        axis.title = element_text(size = 13))
```


Similarly, the nitrification rates were significantly negatively associated whereas the nitrogen mineralization rates were significantly positively associated with microbial biomass nutrients (@fig-i). However, these relationships were also not found to be significant under exotic and native plantations, when analysed separately. 

```{r fig.width=7, fig.height=6}
#| label: fig-i
#| fig-cap: "Relationship of microbial biomass nutrients with nitrification and nitrogen mineralisation rates. The strength of relationship is tested using the linear Pearson's correlation coefficient (represented as *r*) at 0.05 significance level."

read.csv("soil-data.csv") |>
  select(Origin, nitrif:nminer, mbc:mbp) |>
  pivot_longer(cols = nitrif:nminer, names_to = "nitrogen_cycling", 
               values_to = "values_nc") |>
  mutate(nitrogen_cycling = fct_relevel(nitrogen_cycling, 
                                        c("nitrif", "nminer"))) |>
  mutate(nitrogen_cycling = 
           recode(nitrogen_cycling, nitrif = "Nitrification",
                  nminer = "N-mineralisation")) |>
  pivot_longer(cols = mbc:mbp, names_to = "microbial_nutrients", 
               values_to = "values_mn") |>
  mutate(microbial_nutrients = toupper(microbial_nutrients)) |>
  
  ggplot(aes(x = values_mn, y = values_nc)) +
  geom_point(aes(color = Origin, shape = Origin), size = 3, alpha = 0.5) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  geom_smooth(alpha = 0.2, method = "lm", lwd = 1, se = FALSE) +
  stat_cor(aes(y = values_nc * 1.1), 
           label.y.npc = 1, cor.coef.name = "r", 
           p.accuracy = 0.001) +

  facet_grid(nitrogen_cycling ~ microbial_nutrients, scales = "free", 
             labeller = label_parsed
             ) +
  theme_bw() +
  labs(x = "Microbial biomass nutrients (mg/kg)",
       y = expression(paste("Nitrogen cycling (mg ", ~kg^{-1}~month^{-1}, ")"))) +
  theme(legend.position = "top", legend.title = element_blank(), 
        legend.text = element_text(size = 12),
        strip.background = element_rect(fill = "grey98"),
        strip.text = element_text(size = 13),
        axis.text = element_text(size = 12, color = "grey40"),
        axis.title = element_text(size = 13))
```

Principal Component Analysis (PCA) correlation biplot suggests that some soil properties can be grouped on the basis of their strong associations. The first two principal axes explained about 70% of total variation in the data (@fig-j). The soil sand content is negatively correlated with ammonium nitrogen, soil organic carbon (soc) and microbial biomass nutrients (mbc, mbn, mbp) whereas positively correlated with nitrification rates. Similarly, the silt content is positively associated with nitrate-nitrogen, nitrification rates and soil organic carbon, whereas it was negatively associated with clay content, inorganic phosphorus (PO~4~-P) and microbial biomass nitrogen. Thus, the PCA correlation biplot also supports the above derived relationships of soil texture with microbial biomass nutrients and nitrogen cycling, in addition to the relation of SOC and MBC. 


```{r}
#| label: fig-j
#| fig-cap: "Principal Component Analysis correlation biplot for the soil properties under the 5-year plantations of exotic and native species on coal mine spoil. The points represent the plantation species and arrows display the soil properties variables. Each eigenvector is scaled to the square root of its eigenvalue. The angles between variables in the biplot reflect their correlations. Angles close to zero degrees reflects a strong positive, whereas angles close to 180 degrees reflect the strong negative correlation between the variables. Very low or no correlation is represented by an angle close to 90 degrees."


library(vegan)

cbpal <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", 
           "#D55E00", "#CC79A7")

mydata <- read.csv("soil-data.csv")
env <- mydata[, 4:21]

env.pca <- summary(rda(env, scale = TRUE)) # default scaling = 2
pca.sum <- data.frame(env.pca$sites[, 1:2])

pca.sum$Species <- factor(x = mydata$Species, 
                          labels = c("Acacia auriculiformis" = "AA", 
                                     "Albizia lebbeck" = "AL",
                                     "Albizia procera" = "AP", 
                                     "Cassia siamea" = "CS",
                                     "Casuarina equisetifolia" = "CE", 
                                     "Dendrocalamus strictus" = "DS",
                                     "Grevillea pteridifolia" = "GP", 
                                     "Tectona grandis" = "TG"))
pca.sum$Origin <- mydata$Origin

pca.var <- data.frame(env.pca$species[,1:2])

xlab <- paste("PC1 (", round(env.pca$cont$importance[2, 1] * 100, 2), " %)",  
              sep = "")
ylab <- paste("PC2 (", round(env.pca$cont$importance[2, 2] * 100, 2), " %)",
              sep = "")


ggplot(data = pca.sum, aes(x = PC1, y = PC2)) + 
  geom_vline(xintercept = 0, color = "grey70", lty = 2) + 
  geom_hline(yintercept = 0, color = "grey70", lty = 2) +
  geom_point(aes(color = Species, fill = Species, shape = Origin), size = 4, 
             alpha = 0.7) +
  scale_shape_manual(values = c(21, 24)) +
  scale_fill_manual(values = cbpal) +
  scale_color_manual(values = cbpal) +
  geom_segment(data = pca.var, aes(x = 0, y = 0, xend = PC1, yend = PC2), 
               arrow = arrow(length = unit(0.2, "cm")), color = "grey70") +
  ggrepel::geom_text_repel(data = pca.var, 
                           aes(x = PC1, y = PC2,label = rownames(pca.var)), 
                           color = "grey20") +
  labs(x = xlab, y = ylab) +
  
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        legend.title = element_text(size = 13),
        legend.text = element_text(size = 12),
        axis.text = element_text(size = 12, color = "grey40"),
        axis.title = element_text(size = 13))
```


## Discussion

###	Soil physico-chemical properties under exotic and native plantations

Fresh mine spoils are characterized by neutral pH, high bulk density, low water holding capacity (WHC), and deficiency of soil nutrients [@Singh2004a]. However, the older mine spoils have relatively better physical properties as compared to fresh spoils. Soil physical properties are distinctly better in the natural forests as compared to the mine spoil, suggesting that plantations improve soil physical properties [@Singh1979]. The present study found that the bulk density and pH were similar under both plantations indicating that both types of plantations have similar effects on bulk density and pH. Further, it might be possible a time frame of just five years might be insufficient to observe effects on bulk density and pH. The higher clay content under native species suggests that the roots of these species might have released some acidic substances, which caused chemical withering. Among native species, *A. procera* and *A. lebbeck* are most suitable for soil restoration [@Singh2004b]. 

Soil nutrients are usually associated with litterfall and litter decomposition rates, since litter is a major source of soil nutrients in terrestrial ecosystems. A recent comparison of 5-year-old exotic and native plantations on coal mine spoil suggested that native plantations have more litterfall and decomposition rates as compared to exotic plantations, though the differences were non-significant [@Singh2022]. Ammonification is the process of formation of organic nitrogen from the decomposition of organic matter including plant litter. The higher NH~4~-N under native plantations suggests a higher ammonification rate, which might be associated with relatively higher litterfall and faster decomposition rates under native plantations as compared to exotic plantations. Further, it also indicates that ammonifying bacteria might have developed and colonized faster under native plantations than the exotic plantations. On the other hand, the higher NH~4~-N and lower NO~3~-N under native species suggests a lower nitrification rate, which in turn indicate low abundance and activity of nitrifying bacteria [@Isobe2020]. Lower nitrification rates as compared to higher ammonification rates might be the consequence of underlying microbial diversity since the latter involves highly diverse microbes [@Isobe2020]. Further, the activity of nitrifiers is sensitive to water availability, drier conditions of the coal mine spoils might have restricted the nitrification rates [@Isobe2020]. Furthermore, it may also be possible that available NO~3~-N might be readily absorbed by the plants resulting in low net NO~3~-N under the native plantations. Similarly, inorganic phosphate under native plantations again suggests development of microbes including mycorrhizal fungi. 

Although the total soil organic carbon (SOC) and total kjeldahl nitrogen (TKN) were similar under both plantations, total phosphorus content was better under native plantations than the exotic plantations. Among native species, *Albizia lebbeck* and *Dendrocalamus strictus* seemed to be suitable to raise the C and N capital in the redevelopment soil of mine spoil [@Singh2006b]. However, these concentrations were considerably lower than those in natural deciduous forests (organic C = 0.47–2.1%, total N = 0.05–0.16%) [@Singh1993]. The carbon to nitrogen ratio (C:N ratio) determines the mineralization and immobilization of nutrients from the organic matter. A lower C:N ratio favors mineralization whereas a higher C:N ratio favors immobilization. The soil C:N ratio was close to 10:1 in the present study suggests faster mineralization to release nutrients. This ratio was slightly lower under native plantation (9.5:1) than the exotic plantation (9.8:1). 

The nutrients in organic matter are first immobilized by the microbes in the form of microbial biomass. When these microbes die, the nutrients are released back to the soil through mineralization [@Singh1989]. Thus, higher microbial biomass nutrients are preferred for redevelopment and restoration of degraded soils because it aids in re-establishment of nutrient cycle [@Srivastava1989]. Therefore, the present study advocates the suitability of native species for recovery of nutrient cycling as the microbial biomass nutrients (C, N and P) were significantly higher native plantations as compared to exotic plantations. Further, the lower microbial biomass C:N ratio under native plantations suggests faster mineralization rates under these plantations as compared to exotic plantations.  Moreover, microbes consumed a higher fraction of total soil nutrients under native plantations as indicated by higher values of microbial biomass nutrients to the total soil nutrients, which is considered as a measure of the success of reclamation efforts [@Insam1988; @Izquierdo2005]. This higher nutrient immobilization rates under native plantations again favors native species plantations for re-establishment of nutrient cycling and rehabilitation of mine spoil. 

### Relationships of soil physico-chemical properties

The relationships between soil organic matter, microbial biomass, and microbial activity have been proposed as soil maturity indicators [@Insam1988]. A positive linear relationship between soil organic carbon and microbial biomass carbon indicates that the two parameters mirror each other during the early soil redevelopment period. However, the relationship was stronger and more significant under native plantations as compared to the exotic plantations. This positive association suggests that increased input of organic carbon might reduce competition among heterotrophic microbes resulting in higher microbial biomass carbon. Thus, higher availability of energy substrate might have increased their assimilation and growth rates. 

Soil texture can influence the soil processes through effects on microbes, surface area, porosity and water availability. The amount and type of clay in a soil can affect mineralization rates as coarse-textured soils low in clay tend to increase the rate, and as the soil clay content increases, the rate decreases. A very strong positive correlation among the microbial biomass nutrients (C, N, P) suggests that these are associated with each other i.e., carbon acquisition is also accompanied by acquisition of nitrogen and phosphorus by the microbes. 

Considering all together, all the species substantially differed in their soil restoration potential possibly due to individual species traits. All native species performed much better than the exotic species in improving soil physicochemical properties of coal mine spoil. Among native species, *A. lebbeck* can be considered as the most suitable species for degraded soil which is advocated by earlier studies [@Singh2004a; @Singh2004b]. However, the soil restoration potential of *T. grandis* was relatively lower than other native species but still better than exotic species. This might be due to slow growth rates and low amount of litterfall under these plantations. However, *T. grandis* species cannot be ignored due to its high economic importance and higher rates of biodiversity development under plantations of this species as compared to other native species [@Kumar2020]. Thus, all the species can be broadly divided into three groups (i) all exotic species, (ii) *T. grandis*, and (iii) native species excluding *T. grandis* in order of better soil restoration potential in terms of soil physicochemical properties such as soil texture, soil nutrients and nutrient cycling.

## Conclusions

The present study suggested that exotic and native species differ in their soil restoration potential of coal mine spoil. Native species are clearly more effective for soil redevelopment and restoration than the exotic species irrespective of their leguminous or non-leguminous nature. Soil physicochemical properties such as clay content, available soil nutrients and fertility can be substantially improved by planting more native species than the exotic species. Thus, an optimal combination of plantation species with highest soil-building capacities should be planted on coal mine spoils.native species have satisfactory performance in the restoration of coal mine habitat rather than by exotic species. However, more comparative knowledge on the species-specific effects on ecosystem restoration is still required. The increased understanding about soil properties relationships will be beneficial to restoration practitioners for assessing the soil quality. Our study provided the evidence for positive relationship of microbial biomass carbon and soil organic carbon. Also, the positive association of microbial biomass nutrients with clay content and nitrogen mineralization rates were supported by our data. Thus, soil clay content can be used as an indicator for soil quality during ecological restoration.


## Acknowledgements {.appendix}

Authors are grateful to the Chairperson, Department of Botany, Panjab University, Chandigarh as well as the Chairperson, Department of Botany, Banaras Hindu University, Varanasi for providing all necessary facilities required for the work. The authors are also deeply thankful to Prof. J. S. Singh for his constructive guidelines and supervision during the study. University Grants Commission, Government of India is acknowledged for financial assistance in GATE fellowship to ANS and Junior Research Fellowship to AK.

## Author's contribution {.appendix}
*Anand Narain Singh:* Conceptualization, Data curation (lead), Formal Analysis (equal), Investigation (lead), Methodology (lead), Project administration, Resources, Supervision, Validation (lead), Writing – original draft (lead), Writing – review & editing (equal). *Abhishek Kumar:* Data curation (supporting), Formal Analysis (equal),  Funding acquisition, Methodology (supporting), Software, Validation (supporting), Visualization (lead), Writing – original draft (supporting), Writing – review & editing (equal).